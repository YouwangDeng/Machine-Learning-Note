# Machine Learning Note
## Imooc Course
### Install GraphLab Create and IPython Notebook
### Regression - predict house prices
* 线性拟合
* 通过训练-测试分离来评估过拟合
    * 训练集
    * 测试集
    * 训练误差
        * 随着模型复杂度增加而降低
    * 测试误差
        * 随着模型复杂度增加可能（先降低后增加）
* 加入其他特征
    * 房屋大小
    * 卫生间数量
    * 卧室数量
    * 庭院大小
    * ...
* 其他例子
    * 薪资预测
    * 股票预测
        * 近期的股价
        * 新闻事件
        * 相关商品
    * 微博流行度
        * 粉丝数
        * 粉丝的粉丝数
        * 微博内容
        * 话题的流行度
        * 以往的微博转发数
    * 智能房屋
        * 基于有传感器的数据来预测没有传感器的数据
* 数据 --> 特征提取 --> 机器学习模型 --> 预测结果 --> 误差度量 --> 机器学习算法 --> 完善机器学习模型

### Classification - reviews emotion analysis
* 线性分类器（输出是输入的加权和）
    * 通过训练数据得到每个词语的权重
    * 给句子打分
* 决策边界 - 一条线或者平面或者超平面
* 分类误差/精度
* 如何评价精度-类别是否不平衡
* 分类错误
    * 混淆矩阵 - 二元分类
    * 混淆矩阵 - 多元分类
* 学习曲线
    * 模型偏差
    
### 聚类和相似度：文档检索
* 文档的单词计数表示
    * 词袋模型
        * 忽略单词顺序
        * 对单词表的每一个单词计数，得到一个稀疏向量
        * 测量相似度，对应位置相乘然后相加
        * 此模型问题：
            * 文档长度double，相似度double
            * 解决方法：归一化，（求平方相加开根号）作为分母
            * 生僻词，在语料库中出现频率不高，但是对于文章特征影响较大的词
            * 关键词，在文章中频繁出现（局部常见），在语料库中罕见出现（全剧罕见）
        * TF-IDF 词频-逆向文档频率
            * 词频 tf
            * 逆向文档频率idf=log（文档数/（1+包含单词的文档））
            * tf*idf 新的词频向量
* 检索相似的文档
    * 最近邻域搜索
        * 查询文档
        * 语料库
        * 指定距离度量
        * 输出最相似文档集合
        * 特例：最近邻搜索
            * 在语料库中搜索每个文档
                * 计算s=similarity(target,i)
                * 记录最相似的文档
            * 返回
        * 特例k-最近邻搜索
            * 算法和上面相同
* 文档聚类
    * 根据主题对文档分组
    * 已知标签文档的训练集
    * 实际上是多元分类问题，监督学习的应用 
* 聚类
    * 假设不提供标签
    * 想要发现集群结构
        * 输入：作为向量的文档
        * 输出：集群标签
    * 一个无监督学习任务
    * 集群通过中心和形状定义
* k - 均值
    * 假设相似性度量=与集群中心点的距离（越小越好）
    * 算法
        * 随机选择k个中心点
        * 把观测分配给最近的中心点
        * 把集群中心点更新为被分配给原中心点观测的均值
        * 重新分配给最近的中心点
        * 重复这个过程，直至收敛
* 聚类其他应用
    * 图像搜索
    * 通过病况来分组病人
    * Amazon中的商品
    * 组织网页搜索结果
    * 发现相似的邻居
        * 预测房价
        * 预测犯罪率进行警力分配 

### 推荐系统
* 信息过载 --> 个性化
* 影片推荐
* 商品推荐
* 音乐推荐
* 社交app朋友推荐
* 药物-靶相互作用
* 构建推荐系统
    * 最简单方法：流行度
    * 分类模型：输入用户信息，购买历史，商品信息，其他信息，分类起输出yes或no
    * 协同过滤
        * 同现矩阵
            * 行列都是商品，存储同时买商品i和j的用户数
            * 对称性：aij = aji
        * 应用同现矩阵做推荐
            * 找出矩阵中的行，找到最大列，推荐该商品
        * 同现矩阵必须正规化 - 防止流行商品对推荐的影响 
        * 正规化同现矩阵
            * Jaccard相似度：把流行度正规化
            * 同时买商品i和j的人的数量，除以买商品i或j的人数量
        * 购买商品的加权平均
            * 对于每个商品j通过组合相似度进行计算，可加入最近购买权重值，然后排序，进行推荐
    * 冷启动问题
        * 如果来了一个新用户或新商品怎么办
    * 通过矩阵分解来发现隐藏的结构
        * 以电影推荐为例
        * 矩阵补全问题：矩阵很大，但是很稀疏
        * 利用主题r向量来描述电影，利用l向量描述用户
        * 利用矩阵形式预测L*R矩阵相乘
        * 矩阵分解模型：从数据发现特征向量
        * 但是仍不能解决冷启动问题
    * 特征 + 矩阵分解
        * 可以解决冷启动问题
* 推荐系统的精度度量
    * 召回率：推荐出的喜欢的商品/全部喜欢的商品
    * 准确率：推荐出的喜欢的物品/推荐的物品
    * 最优推荐：召回率=1，准确率=1
    * 准确率-召回率曲线
        * 输入一个指定的推荐系统，输出算法的准确率-召回率曲线，为了画出曲线，需要变化推荐商品的阈值
        * 最优的推荐系统是平行于召回率的直线
        * 比较不同的算法
            * 对于给定的准确率，希望召回率越高越好
            * 单一的度量标准：最大的曲线下面积AUC
            * 另一种方法：设置理想的召回率，然后最大化准确率    